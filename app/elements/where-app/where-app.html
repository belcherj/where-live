<link rel="import" href="../../bower_components/polymer/polymer.html">

<link rel="import" href="../../bower_components/core-toolbar/core-toolbar.html">
<link rel="import" href="../../bower_components/core-drawer-panel/core-drawer-panel.html">
<link rel="import" href="../../bower_components/core-label/core-label.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../bower_components/paper-checkbox/paper-checkbox.html">
<link rel="import" href="../../bower_components/google-map/google-map.html">
<link rel="import" href="../../bower_components/font-roboto/font-roboto.html">

<polymer-element name="where-app" attributes="">
  <template>
    <link rel="stylesheet" href="where-app.css">

    <core-drawer-panel>

      <core-header-panel drawer class="drawer">
        <core-label center horizontal layout>
          <paper-checkbox for></paper-checkbox>
          <div>Foo</div>
        </core-label>
      </core-header-panel>

      <core-header-panel main>
        <core-toolbar class="header">
          <paper-icon-button core-drawer-toggle icon="menu" role="button" tabindex="0" aria-label="Menu"></paper-icon-button>
          <div>Title</div>
        </core-toolbar>

        <google-map map="{{map}}"></google-map>
      </core-header-panel>

    </core-drawer-panel>
  </template>
  <script>
    (function () {
      var dataset = [
        {
          latitude: 37.782,
          longitude: -122.447,
          magnitude: randomNumber()
        },
        {
          latitude: 37.782,
          longitude: -122.445,
          magnitude: randomNumber()
        },
        {
          latitude: 37.782,
          longitude: -122.443,
          magnitude: randomNumber()
        },
        {
          latitude: 37.782,
          longitude: -122.441,
          magnitude: randomNumber()
        },
        {
          latitude: 37.782,
          longitude: -122.439,
          magnitude: randomNumber()
        },
        {
          latitude: 37.782,
          longitude: -122.437,
          magnitude: randomNumber()
        },
        {
          latitude: 37.782,
          longitude: -122.435,
          magnitude: randomNumber()
        },
        {
          latitude: 37.785,
          longitude: -122.447,
          magnitude: randomNumber()
        },
        {
          latitude: 37.785,
          longitude: -122.445,
          magnitude: randomNumber()
        },
        {
          latitude: 37.785,
          longitude: -122.443,
          magnitude: randomNumber()
        },
        {
          latitude: 37.785,
          longitude: -122.441,
          magnitude: randomNumber()
        },
        {
          latitude: 37.785,
          longitude: -122.439,
          magnitude: randomNumber()
        },
        {
          latitude: 37.785,
          longitude: -122.437,
          magnitude: randomNumber()
        },
        {
          latitude: 37.785,
          longitude: -122.435,
          magnitude: randomNumber()
        }
      ];

      function randomNumber() {
        return Math.floor((Math.random() * 100) + 1);
      }

      Polymer({
        publish: {
          mapInitiated: false,
          points: dataset
        },

        mapChanged: function() {
          if(this.mapInitiated) {
            return;
          }
          this.points.forEach(function(point) {
            var circle = {
              path: google.maps.SymbolPath.CIRCLE,
              fillColor: 'red',
              fillOpacity: 0.2,
              scale: point.magnitude,
              strokeColor: 'white',
              strokeWeight: 0.5
            }
            var position = new google.maps.LatLng(point.latitude, point.longitude);
            var marker = new google.maps.Marker({
              position: position,
              icon: circle,
              map: this.map
            })
          }, this);

          return
        }

      });
    })();
  </script>
</polymer-element>
